#include <bits/stdc++.h>
using namespace std;

#define ll long long int
#define ln '\n'
#define yes cout << "YES" << ln
#define no cout << "NO" << ln
const int N = 1e6 + 9, mod = 1e9 + 7;

void solve() {
    int n;
    cin >> n;
    vector<int>ar(n);
    int cnt = 0;
    for(int i = 0; i < n; i++){
        cin >> ar[i];
    }
    // int x = 0;
    // for(int i = 0; i < n - 1; i++){
    //     x += ar[i + 1] - ar[i];
    // }
    // cout << abs(x) << " " << abs(ar.back() - ar.front()) <<ln; 
    if(ar[0] == -1)
        ar[0] = ar[n - 1];
    if(ar[n - 1] == -1)
        ar[n - 1] = ar[0];

    for(int i = 0; i < n; i++){
        if(ar[i] == -1){
            ar[i] = 0;
        }
    }
    cout << abs(ar[n - 1] - ar[0]) <<ln;
    for(auto x : ar){
        cout << x << " ";
    }
    cout << ln;
}
int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    int t = 1;
    cin >> t;
    //int casee = 1;
    while(t--) {
        //cout<<"Case "<<casee<<": ";

        solve();

        // casee++;
    }

    return 0;
}

/**************

LEARNING IS FUN
SO ENJOY IT 

***************/

